import requests
from bs4 import BeautifulSoup

from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from webdriver_manager.chrome import ChromeDriverManager

driver = webdriver.Chrome(ChromeDriverManager().install())

url = "https://pwnable.kr/play.php"
response = requests.get(url)
# parse html
page = str(BeautifulSoup(response.content))
print(f"HTML of {url} \n {page}")

# TODO
# Set up the WebDriver (this example uses Chrome; adjust for your browser)
#driver = webdriver.Chrome(executable_path='/path/to/chromedriver')
# Open the URL
driver.get(url)
# Wait for the page to load
WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.TAG_NAME, "body")))
# Find all figures (adjust the selector as needed)
figures = driver.find_elements(By.CSS_SELECTOR, "figure")
# Loop through figures and click each one
for index, figure in enumerate(figures, start=1):
    # Click the figure
    figure.click()
    
    # Wait for the corresponding layerPop div to appear
    layer_pop_id = f"layerPop{index}"
    WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.ID, layer_pop_id)))
    
    # Find the textarena div within the layerPop div and get its text
    textarena = driver.find_element(By.CSS_SELECTOR, f"#{layer_pop_id} .textarena")
    text_content = textarena.text    

    print(text_content)

# Close the browser when done
driver.quit()

